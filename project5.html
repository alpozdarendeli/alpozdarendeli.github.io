<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            background-color: #f4f4f4;
            color: #333;
        }
        h1, h2 {
            color: #2c3e50;
        }
        h1 {
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 10px;
        }
        .project-overview {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .image-griddd {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .image {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        .image img {
            max-width: 150%;
            width: 150%;
            height: auto;
        }
        .image-gri {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .image-gr {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 15px;
            margin-bottom: 20px;
            justify-items: center; 
            align-items: center; 
        }
        .image-g {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .image-gi {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .image-container {
            background-color: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 3px;
        }
        .image-subtitle {
            margin-top: 8px;
            font-style: italic;
            font-size: 0.9em;
            color: #555;
        }
        .clear-float {
            clear: both;
            width: 100%;
        }
        .image-description {
            margin-top: 8px;
            font-style: italic;
            font-size: 0.9em;
            color: #555;
        }
                
        .equation {
            margin: 20px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Project 5: Fun With Diffusion Models!</h1>
    <h2>Alp Eren Ozdarendeli</h2>

    <div class="Background">
        <h1>Part A</h2>
    </div>
    
    <div class="project-overview">
        <h2>Part 0: Setup</h2>
            <p> For the setup part, I use DeepFloyd IF as the diffusion model. To test the setup, I used the given prompts to generate the following outputs:
        <div class="image-grid">
            <div class="image-container">
                <img src="images5/parta1_1.png" alt="taj.jpg">
                <p class="image-subtitle"> an oil painting of a snowy mountain village</p>
            </div>
            <div class="image-container">
                <img src="images5/parta1_4.png" alt="taj.jpg">
                <p class="image-subtitle"> a man wearing a hat</p>
            </div>
            <div class="image-container">
                <img src="images5/parta1_5.png" alt="taj.jpg">
                <p class="image-subtitle"> a rocket ship</p>
            </div>
        </div>
        <div class="clear-float"></div>
            <p> The generated images actually represent the prompts pretty well. To test the effect of num_inference_steps on the outputs, I test the prompt 'an oil painting of a snowy mountain village' with num_inference_steps 7 and 46 in addition to 20 given above. Here are outputs with num_inference_steps 7 and 46 respectively:<p>
            <div class="image-gri">
            <div class="image-container">
                <img src="images5/parta1_2.png" alt="taj.jpg">
                <p class="image-subtitle"> an oil painting of a snowy mountain village (num_inference_steps = 7)</p>
            </div>
            <div class="image-container">
                <img src="images5/parta1_3.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">an oil painting of a snowy mountain village (num_inference_steps = 46)</p>
            </div>
        </div>
        <div class="clear-float"></div>
        <p>With increasing num_inference_steps, the images become more detailed and better reflect the prompts.</p>
        <h2>1.1 Implementing the Forward Process</h2>
        <p>Now, I implement the forward process. For the forward process, given a clean image, I get a noisy image for a timestep t by sampling noise from a Gaussian. Also, I scale the image to 64 x 64 dimensions. The original Campanile image is shown below at different noise levels.<p>
        <div class="image-grid">
            <div class="image-container">
                <img src="images5/noise1.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=250</p>
            </div>
                        <div class="image-container">
                <img src="images5/noise2.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=500</p>
            </div>
                        <div class="image-container">
                <img src="images5/noise3.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=750</p>
            </div>
        </div>
        <div class="clear-float"></div>
        <h2>1.2 Classical Denoising</h2>
<p>For classical denoising I take a noisy image and try to denoise it by Gaussian filtering. Here are the results for different timestamps:</p>
        <div class="image-grid">
            <div class="image-container">
                <img src="images5/noise1.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=250</p>
            </div>
                        <div class="image-container">
                <img src="images5/noise2.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=500</p>
            </div>
                        <div class="image-container">
                <img src="images5/noise3.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=750</p>
            </div>
        </div>
        <div class="clear-float"></div>
                        <div class="image-grid">
            <div class="image-container">
                <img src="images5/cdns1.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Classical Denoised Campanile at t=250</p>
            </div>
                        <div class="image-container">
                <img src="images5/cdns2.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Classical Denoised Campanile at t=500</p>
            </div>
                        <div class="image-container">
                <img src="images5/cdns.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Classical Denoised Campanile at t=750</p>
            </div>
        </div>
        <div class="clear-float"></div>
    <h2>1.3 One-Step Denoising</h2>
    <p> For one-step denoising, I use a pretrained denoiser stage_1.unet to find the noise in the images. Then, I remove this image to recover a clean image:</p>
                <div class="image-grid">
            <div class="image-container">
                <img src="images5/noise1.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=250</p>
            </div>
                        <div class="image-container">
                <img src="images5/noise2.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=500</p>
            </div>
                        <div class="image-container">
                <img src="images5/noise3.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">Noisy Campanile at t=750</p>
            </div>
        </div>
        <div class="clear-float"></div>
                    <div class="image-grid">
            <div class="image-container">
                <img src="images5/odn1.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">One-Step Denoised Campanile at t=250</p>
            </div>
                        <div class="image-container">
                <img src="images5/odn2.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">One-Step Denoised Campanile at t=500</p>
            </div>
                        <div class="image-container">
                <img src="images5/odn3.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">One-Step Denoised Campanile at t=750</p>
            </div>
        </div>
        <div class="clear-float"></div>
    <h2>Iterative Denoising</h2>
    <p> For iterative denoising, I create a new list of timesteps,strided_timesteps, to skip some steps. The stride of steps will be 30. In the following, denoised image is displayed at every fifth step and final clean image prediction is shown in comparison to other techniques:<p>
                    <div class="image-grid">
            <div class="image-container">
                <img src="images5/f1.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/f2.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/f3.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/f4.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/f5.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/f6.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/f7.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/f8.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/f9.png" alt="taj_sharp.jpg">
            </div>
        </div>
        <div class="clear-float"></div>
        <h2>1.5 Diffusion Model Sampling </h2>
        <p> For this part, I use iterative denoising to generate images from scratch. I pass in random noise, and the function denoises pure noise. Here are 5 samples: </p>
                        <div class="image-griddd">
            <div class="image-container">
                <img src="images5/sample1.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/sample2.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/sample3.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/sample4.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/sample5.png" alt="taj_sharp.jpg">
            </div>
        </div>
        <div class="clear-float"></div>
        <h2>1.6 Classifier-Free Guidance (CFG)</h2>
        <p> The quality of the results in the previous section were not great. To significantly improve image quality, I will use CFG in this section. For CFG, I compute both conditional and unconditional noise estimate. In CFG, we have a hyperparameter, named scale in the function, that determines its strength. When scale is 0, CFG is essentially unconditional noise estimate but when scale is bigger than 1, I am able to produce much more quality images. Here are 5 samples from CFG with scale=7:</p>
                                        <div class="image-griddd">
            <div class="image-container">
                <img src="images5/cfg1.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/cfg2.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/cfg3.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/cfg4.png" alt="taj_sharp.jpg">
            </div>
                        <div class="image-container">
                <img src="images5/cfg5.png" alt="taj_sharp.jpg">
            </div>
        </div>
        <div class="clear-float"></div>
    <h2> 1.7 Image-to-image Translation </h2>
    <p>In this section, I follow the SDEdit algorithm. I noise the original image a little bit first, then, force it back to the image manifold without conditioning. As a result, I get an image similar to the original image. For this section, I will use the 3 test images, one of them being the Campanile photo.Here are the edits of the test images, at different noise levels 1, 3, 5, 7, 10, 20 with "a high quality photo":</p>
                <div class="image-g">
            <div class="image-container">
                <img src="images5/1-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/1-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/1-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/1-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/1-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/1-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
                                <div class="image-container">
                <img src="images5/campanile.png" alt="taj_sharp.jpg">
                                    <p class="image-subtitle">Original Campanile</p>
                                </div>
                    <div class="image-container">
                        <img src="images5/2-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/2-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/2-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/2-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/2-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/2-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
           <div class="image-container">
                <img src="images5/kopruu.png" alt="taj_sharp.jpg">
               <p class="image-subtitle">Original Golden Gate</p>
            </div>
        <div class="image-container">
                            <img src="images5/3-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/3-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/3-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/3-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/3-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/3-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
                            <div class="image-container">
                <img src="images5/kedi.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">Original cat</p>
            </div>
        </div>
        <div class="clear-float"></div>
    <h2>1.7.1 Editing Hand-Drawn and Web Images </h2>
    <p> The technique I used in the previous section also performs pretty well for nonrealistic images that is projected it to the natural image manifold. To test for these, I will use 1 image from web and 2 images by handwriting:</p>
                    <div class="image-g">
            <div class="image-container">
                <img src="images5/w1-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/w1-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/w1-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/w1-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/w1-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/w1-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
                                <div class="image-container">
                <img src="images5/w1.png" alt="taj_sharp.jpg">
                                    <p class="image-subtitle">Original UP</p>
                                </div>
                    <div class="image-container">
                        <img src="images5/w2-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/w2-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/w2-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/w2-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/w2-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/w2-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
           <div class="image-container">
                <img src="images5/w2.png" alt="taj_sharp.jpg">
               <p class="image-subtitle">Original Handwriting Picture</p>
            </div>
        <div class="image-container">
                            <img src="images5/w3-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/w3-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/w3-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/w3-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/w3-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/w3-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
                            <div class="image-container">
                <img src="images5/w3.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">Original Handwriting Image 2</p>
            </div>
        </div>
        <div class="clear-float"></div>
    <h2> 1.7.2 Inpainting </h2>
    <p>Based on the Repaint paper, I implement inpainting in this section. Given a mask, when I run the diffusion denoising loop, I replace everything except the mask area with the original images but with the added noise based on timestep t. Here are my results for inpainting: </p>
        <div class="image-gi">
            <div class="image-container">
                <img src="images5/img1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">Original</p>

            </div>
                        <div class="image-container">
                <img src="images5/mask1.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">Mask</p>
            </div>
                        <div class="image-container">
                <img src="images5/toreplace1.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">To Replace</p>
            </div>
                        <div class="image-container">
                <img src="images5/replaced1.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">Final</p>
            </div>
            <div class="image-container">
                            <img src="images5/img2.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">Original</p>

            </div>
                        <div class="image-container">
                <img src="images5/mask2.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">Mask</p>
            </div>
                        <div class="image-container">
                <img src="images5/toreplace2.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">To Replace</p>
            </div>
                        <div class="image-container">
                <img src="images5/replaced2.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">Final</p>
            </div>
            <div class="image-container">
                        <img src="images5/img3.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">Original</p>

            </div>
                        <div class="image-container">
                <img src="images5/mask3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">Mask</p>
            </div>
                        <div class="image-container">
                <img src="images5/toreplace3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">To Replace</p>
            </div>
                        <div class="image-container">
                <img src="images5/replaced3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">Final</p>
            </div>
            </div>
        </div>
        <div class="clear-float"></div>
    <h2>1.7.3 Text-Conditional Image-to-image Translation</h2>
    <p>In this section, I will do the same thing as the previous section but with SDEdit algorithm. Differently from the original SDEdit, I will change the prompt from "a high quality photo" to the prompt of my choosing to guide the projection with text prompt. Here are the results with different noise levels:</p>
                        <div class="image-g">
            <div class="image-container">
                <img src="images5/c1-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/c1-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/c1-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/c1-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/c1-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/c1-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
                                <div class="image-container">
                <img src="images5/campanile.png" alt="taj_sharp.jpg">
                                    <p class="image-subtitle">Original UP</p>
                                </div>
                    <div class="image-container">
                        <img src="images5/c2-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/c2-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/c2-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/c2-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/c2-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/c2-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
           <div class="image-container">
                <img src="images5/c2.png" alt="taj_sharp.jpg">
               <p class="image-subtitle">Original Handwriting Picture</p>
            </div>
        <div class="image-container">
                            <img src="images5/c3-1.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">i_start=1</p>

            </div>
                        <div class="image-container">
                <img src="images5/c3-3.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=3</p>
            </div>
                        <div class="image-container">
                <img src="images5/c3-5.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=5</p>
            </div>
                        <div class="image-container">
                <img src="images5/c3-7.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=7</p>
            </div>
                        <div class="image-container">
                <img src="images5/c3-10.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=10</p>
            </div>
                        <div class="image-container">
                <img src="images5/c3-20.png" alt="taj_sharp.jpg">
                                                            <p class="image-subtitle">i_start=20</p>
            </div>
                            <div class="image-container">
                <img src="images5/c3.png" alt="taj_sharp.jpg">
                                <p class="image-subtitle">Original Handwriting Image 2</p>
            </div>
        </div>
        <div class="clear-float"></div>
    <h2> 1.8 Visual Anagrams </h2>
    <p>In this section, I will implement visual diagrams. Visual anagrams are images such that the image looks like a prompt upright, but looks like another prompt when it is turned upside down. I implement visual anagrams by denoising the image at a timestep t with a prompt and get a noise estimate e_1. Then, I turned the image upside down with the other prompt to get a noise estimate e_2. Finally, I turned e_2 upside down and took its average with e_1 with to get the final noise estimate. The denoising step is done with this final noise estimate. Here are my results, and prompts: </p>
    <div class="image-gri">
            <div class="image-container">
                <img src="images5/flip1.png" alt="taj_sharp.jpg">
                <p class="image-subtitle">"an oil painting of people around a campfire"</p>
            </div>
                        <div class="image-container">
                <img src="images5/flip2.png" alt="taj_sharp.jpg">
                            <p class="image-subtitle">"an oil painting of an old man"</p>
            </div>
                        <div class="image-container">
                <img src="images5/flip3.png" alt="taj_sharp.jpg">
                            <p class="image-subtitle">"an oil painting of an octopus in the wavy sea"</p>
            </div>
                        <div class="image-container">
                <img src="images5/flip4.png" alt="taj_sharp.jpg">
                            <p class="image-subtitle">"an oil painting of a curly hair man"</p>
            </div>
                        <div class="image-container">
                <img src="images5/flip5.png" alt="taj_sharp.jpg">
                            <p class="image-subtitle">"a painting of a santa claus"</p>
            </div>
                               <div class="image-container">
                <img src="images5/flip6.png" alt="taj_sharp.jpg">
                            <p class="image-subtitle">"a painting of a deer"</p>
            </div>
        </div>
        <div class="clear-float"></div>
    <h2>1.9 Hybrid Images </h2>
    <p> In this section, I will implement hybrid images implementation. Hybrids images appear as a one prompt from afar, and another from a closer range. To create hybrid images, I will use a similar technique to the previous section. I will first estimate the noise with two different prompts, and will pass them through low-pass filter. Then, I will combine the low frequency component of one noise, and the high frequency component of another. Their combination will form the final noise estimate. Here are my results:</p>
    <div class="image-grid">
        <div class="image-container">
            <img src="images5/hybrid1.png" alt="taj.jpg">
            <p class="image-subtitle">'a lithograph of a skull' and 'a lithograph of waterfalls'</p>
        </div>
                <div class="image-container">
            <img src="images5/hybrid2.png" alt="taj.jpg">
                    <p class="image-subtitle">"a lithography of frog" and "a lithography of autumn leaves"</p>
        </div>
                <div class="image-container">
            <img src="images5/hybrid3.png" alt="taj.jpg">
                    <p class="image-subtitle">"a lithography of Batman symbol" and "a lithography of a city with skyscrapers"</p>
        </div>
        </div>
        <div class="clear-float"></div>
    <h1>Part B: Diffusion Models from Scratch</h1>
    <h2>Training a Single-Step Denoising UNet</h2>
    <p>For the second part of the project, I implement diffusion models from scratch. As a first step, I train single-sept denoising UNet. Firstly, I follow the model diagram for UNet to define its architecture. To train a denoiser with UNet, I use the image dataset from MNIST. Given a clean image, I add a random noise with sigma coefficient to create a noised image. Here are examples of noised images with different sigmas: </p>
    <div class="image-gr">
        <div class="image-container">
            <img src="images5/partbimage4.png" alt="taj.jpg">
        </div>
        </div>
        <div class="clear-float"></div>
    <p> I train UNet to minimize the loss between denoised image from UNet given the noised image and the original clean image. Here are the sample results after training for 1 and 5 epochs:</p>
    <div class="image-gri">
        <div class="image-container">
            <img src="images5/partbimage1.png" alt="taj.jpg">
        </div>
        <div class="image-container">
            <img src="images5/partbimage2" alt="taj_sharp.jpg">
        </div>
        </div>
        <div class="clear-float"></div>
    <p> In the training, I train the model for sigma = 0.5. Let's test how well it will perform for other sigma values:</p>
        <div class="image-gr">
        <div class="image-container">
            <img src="images5/partbimage3.png" alt="taj.jpg">
        </div>
        </div>
        <div class="clear-float"></div>
    <p>Here is the training loss curve during the whole training process:</p>
    <div class="image-gr">
        <div class="image-container">
            <img src="images5/partbimage5.png" alt="taj.jpg">
        </div>
        </div>
        <div class="clear-float"></div>
    <h2>Training a Diffusion Model</h2>
    <p>In this part, I will train a UNet model that iteratively denoises an image. For this, I will implement DDPM. </p>
    <p>Following the diagram and using FCBlocks, I inject time t into the UNet model for conditioning. </p>
  
    </div>
</body>
</html>
    </div>
</body>
</html>
