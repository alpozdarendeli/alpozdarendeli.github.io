<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 3: Face Morphing</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
            background-color: #f4f4f4;
            color: #333;
        }
        h1, h2 {
            color: #2c3e50;
        }
        h1 {
            border-bottom: 2px solid #2c3e50;
            padding-bottom: 10px;
        }
        .project-overview {
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .image-gri {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .image-gr {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 15px;
            margin-bottom: 20px;
            justify-items: center; 
            align-items: center; 
        }
        .image-g {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .image-container {
            background-color: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .image-container img {
            max-width: 100%;
            height: auto;
            border-radius: 3px;
        }
        .image-subtitle {
            margin-top: 8px;
            font-style: italic;
            font-size: 0.9em;
            color: #555;
        }
        .clear-float {
            clear: both;
            width: 100%;
        }
        .image-description {
            margin-top: 8px;
            font-style: italic;
            font-size: 0.9em;
            color: #555;
        }
                
        .equation {
            margin: 20px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>Project 3: Face Morphing</h1>
    <h2>Alp Eren Ozdarendeli</h2>

    <div class="Background">
        <h2>Background</h2>
        <p> In this project, I aim to successfully face morph Larry David to my roommate Can, whom I watch Curb Your Enthuasiasm together.</p>
    </div>
    
    <div class="project-overview">
        <h2>Part 1:  Defining Correspondences</h2>
            <p> To morph two images, we need to select points of correspondences. I used the given tool to select points on the images. After defining the correspondences, I used Delaney Triangulation to triangulate the mean points of Larry David's and Can Ruso's images to find the mean shape. </p>
            <div class="image-grid">
            <div class="image-container">
                <img src="proj3images/ruso_triangulate.png" alt="d_x.jpg">
                <p class="image-subtitle">Ruso points</p>
            </div>
            <div class="image-container">
                <img src="proj3images/david_triangulate.png" alt="d_y.jpg">
                <p class="image-subtitle">David points</p>
            </div>
            <div class="image-container">
                <img src="proj3images/mid_triangulate.png" alt="magnitude.jpg">
                <p class="image-subtitle">Mean points on Can Ruso</p>
            </div>
        </div>
        <div class="clear-float"></div>
        <h2>Part 2: Computing the "Mid-way Face"</h2>
        <!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Affine Transformation Explanation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
    </script>
    <p> In order to compute the mid-way face, we need to find the affine transformation matrix that transforms original points in Larry and Can's images to points in each triangle in the average shape trinagulation. 
    <p>Let's say we have two triangles(one is from one of the original shapes, and one is from the average shape):</p>
    <p>Original triangle has points $p_1, p_2, p_3$, with $(x_i, y_i)$ coordinates for each point</p>
    <p>Transformed triangle has points $q_1, q_2, q_3$ with $(x'_i, y'_i)$ coordinates for each point</p>
    <p>Then, we can write the following matrix multiplication for the transformation operation, the 1s  appended for affine operations:</p>
    <div class="equation">
        \[
        \begin{bmatrix}
        a & b & c \\
        d & e & f \\
        0 & 0 & 1
        \end{bmatrix}
        \begin{bmatrix}
        x_i \\
        y_i \\
        1
        \end{bmatrix} =
        \begin{bmatrix}
        x'_i \\
        y'_i \\
        1
        \end{bmatrix}
        \]
    </div>
    <p>Based on this, we can write the following equations:</p>
    <div class="equation">
        \[
        \begin{aligned}
        ax_i + by_i + c + 0d + 0e + 0f &= x'_i \\
        0a + 0b + 0c + dx_i + ey_i + f &= y'_i
        \end{aligned}
        \]
    </div>
    <p>If we expand this on all 3 points in the triangles:</p>
    <div class="equation">
        \[
        \begin{aligned}
        ax_1 + by_1 + c + 0d + 0e + 0f &= x'_1 \\
        0a + 0b + 0c + dx_1 + ey_1 + f &= y'_1 \\
        ax_2 + by_2 + c + 0d + 0e + 0f &= x'_2 \\
        0a + 0b + 0c + dx_2 + ey_2 + f &= y'_2 \\
        ax_3 + by_3 + c + 0d + 0e + 0f &= x'_3 \\
        0a + 0b + 0c + dx_3 + ey_3 + f &= y'_3
        \end{aligned}
        \]
    </div>
    <p>We can solve this system in matrix form:</p>
    <div class="equation">
        \[
        \begin{bmatrix}
        x_1 & y_1 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & x_1 & y_1 & 1 \\
        x_2 & y_2 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & x_2 & y_2 & 1 \\
        x_3 & y_3 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & x_3 & y_3 & 1
        \end{bmatrix}
        \begin{bmatrix}
        a \\ b \\ c \\ d \\ e \\ f
        \end{bmatrix} =
        \begin{bmatrix}
        x'_1 \\ y'_1 \\ x'_2 \\ y'_2 \\ x'_3 \\ y'_3
        \end{bmatrix}
        \]
    </div>

    <p> Thus, we can use a linear algebra solver to find a, b, c, d, e, and f, and calculate the transformation matrix.</p>
</html>
        <div class="clear-float"></div>
        <div class="image-gri">
        <div class="image-container">
            <img src="proj2images/taj.jpg" alt="taj.jpg">
            <p class="image-subtitle">Taj Mahal</p>
        </div>
        <div class="image-container">
            <img src="proj2images/taj_sharp.jpg" alt="taj_sharp.jpg">
            <p class="image-subtitle">Sharpened Taj Mahal, alpha = 1</p>
        </div>
        </div>
        <div class="clear-float"></div>
        <div class="image-gri">
        <div class="image-container">
            <img src="proj2images/ataturk.jpg" alt="ataturk.jpg">
            <p class="image-subtitle">Mustafa Kemal Ataturk</p>
        </div>
        <div class="image-container">
            <img src="proj2images/ataturk_sharp.jpg" alt="ataturk_sharp.jpg">
            <p class="image-subtitle">Sharpened Mustafa Kemal Ataturk, alpha = 1.2</p>
        </div>
        </div>
        <div class="clear-float"></div>
        <div class="image-container">
            <img src="proj2images/galatasaray.jpg" alt="galatasaray.jpg">
            <p class="image-subtitle">Galatasaray players are celebrating defeating Fenerbahce</p>
        </div>
        <div class="image-container">
            <img src="proj2images/galatasaray_sharp.jpg" alt="galatasaray_sharp.jpg">
            <p class="image-subtitle">Sharpened Galatasaray players are celebrating defeating Fenerbahce, alpha = 2</p>
        </div>
        </div>
        <div class="clear-float"></div>
        <h2>Part 3: The Morph Sequence</h2>
            <p>For this part, my goal is to sharpen images. In order to sharpen an image, I apply Gaussian filter to get the low frequencies of the image. When the low frequencies are substracted from the original image, I get the high frequencies of the image. By adding the high frequencies to the original image, original image can be sharpened. I combines these operations into a single convolution operation which can be formulized convolving each channel of the image with (1 + alpha) * unit_impulse - alpha * gauss_kernel where alpha is the coefficient of the sharpening. </p>
        <div class="clear-float"></div>
        <div class="image-gri">
        <div class="image-container">
            <img src="proj2images/taj.jpg" alt="taj.jpg">
            <p class="image-subtitle">Taj Mahal</p>
        </div>
        <div class="image-container">
            <img src="proj2images/taj_sharp.jpg" alt="taj_sharp.jpg">
            <p class="image-subtitle">Sharpened Taj Mahal, alpha = 1</p>
        </div>
        </div>
        <div class="clear-float"></div>
        <h2>Part 4: The "Mean face" of a population</h2>
            <p>For this part, my goal is to sharpen images. In order to sharpen an image, I apply Gaussian filter to get the low frequencies of the image. When the low frequencies are substracted from the original image, I get the high frequencies of the image. By adding the high frequencies to the original image, original image can be sharpened. I combines these operations into a single convolution operation which can be formulized convolving each channel of the image with (1 + alpha) * unit_impulse - alpha * gauss_kernel where alpha is the coefficient of the sharpening. </p>
        <div class="clear-float"></div>
        <div class="image-gri">
        <div class="image-container">
            <img src="proj2images/taj.jpg" alt="taj.jpg">
            <p class="image-subtitle">Taj Mahal</p>
        </div>
        <div class="image-container">
            <img src="proj2images/taj_sharp.jpg" alt="taj_sharp.jpg">
            <p class="image-subtitle">Sharpened Taj Mahal, alpha = 1</p>
        </div>
        </div>
        <div class="clear-float"></div>
        <h2>Part 5: Caricatures: Extrapolating from the mean</h2>
            <p>For this part, my goal is to sharpen images. In order to sharpen an image, I apply Gaussian filter to get the low frequencies of the image. When the low frequencies are substracted from the original image, I get the high frequencies of the image. By adding the high frequencies to the original image, original image can be sharpened. I combines these operations into a single convolution operation which can be formulized convolving each channel of the image with (1 + alpha) * unit_impulse - alpha * gauss_kernel where alpha is the coefficient of the sharpening. </p>
        <div class="clear-float"></div>
        <div class="image-gri">
        <div class="image-container">
            <img src="proj2images/taj.jpg" alt="taj.jpg">
            <p class="image-subtitle">Taj Mahal</p>
        </div>
        <div class="image-container">
            <img src="proj2images/taj_sharp.jpg" alt="taj_sharp.jpg">
            <p class="image-subtitle">Sharpened Taj Mahal, alpha = 1</p>
        </div>
        </div>
        <div class="clear-float"></div>
        <h2>Part 6: Bells and Whistles</h2>
            <p>For this part, my goal is to sharpen images. In order to sharpen an image, I apply Gaussian filter to get the low frequencies of the image. When the low frequencies are substracted from the original image, I get the high frequencies of the image. By adding the high frequencies to the original image, original image can be sharpened. I combines these operations into a single convolution operation which can be formulized convolving each channel of the image with (1 + alpha) * unit_impulse - alpha * gauss_kernel where alpha is the coefficient of the sharpening. </p>
        <div class="clear-float"></div>
        <div class="image-gri">
        <div class="image-container">
            <img src="proj2images/taj.jpg" alt="taj.jpg">
            <p class="image-subtitle">Taj Mahal</p>
        </div>
        <div class="image-container">
            <img src="proj2images/taj_sharp.jpg" alt="taj_sharp.jpg">
            <p class="image-subtitle">Sharpened Taj Mahal, alpha = 1</p>
        </div>
        </div>
        <div class="clear-float"></div>
    </div>
</body>
</html>
    </div>
</body>
</html>
